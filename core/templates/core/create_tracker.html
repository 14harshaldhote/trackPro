{% extends 'base.html' %}

{% block title %}Create Tracker{% endblock %}

{% block content %}
<div class="main-content">
    <h1>Create New Tracker</h1>

    <div class="grid-2" style="gap: 2rem;">
        <!-- Form -->
        <div class="card">
            <form method="post">
                {% csrf_token %}

                <div class="form-group">
                    <label class="form-label">Tracker Name</label>
                    <input type="text" name="name" required class="form-input" placeholder="e.g., Daily Habits">
                </div>

                <div class="form-group">
                    <label class="form-label">Description (Optional)</label>
                    <input type="text" name="description" class="form-input" placeholder="What is this tracker for?">
                </div>

                <div class="form-group">
                    <label class="form-label">Time Mode</label>
                    <select name="time_mode" class="form-select">
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Template Category</label>
                    <select name="category" class="form-select" id="category-select">
                        <option value="">âž• Custom (I'll add tasks manually)</option>
                        <option value="productivity">ðŸ“Š Productivity</option>
                        <option value="wellbeing">ðŸ§˜ Wellbeing</option>
                        <option value="fitness">ðŸ’ª Fitness</option>
                        <option value="study">ðŸ“š Study</option>
                    </select>
                    <small class="text-secondary">Pre-fills activities based on category</small>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                    Create Tracker
                </button>
            </form>
        </div>

        <!-- Preview -->
        <div class="card" style="background: var(--color-bg);">
            <h3>Template Preview</h3>
            <p class="text-secondary" style="margin-bottom: 1.5rem;">Activities that will be auto-created:</p>

            <div id="preview-content">
                <p class="text-secondary" style="text-align: center; padding: 2rem;">
                    Select a category to see activities
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    const templates = {
        'productivity': [
            { desc: 'Plan the day (Top 3 tasks)', cat: 'planning' },
            { desc: 'Deep Work Session (90 mins)', cat: 'focus' },
            { desc: 'Clear Inbox/Messages', cat: 'admin' },
            { desc: 'Review goals', cat: 'planning' }
        ],
        'wellbeing': [
            { desc: 'Morning Meditation (10 mins)', cat: 'mindfulness' },
            { desc: 'Drink 2L Water', cat: 'health' },
            { desc: 'No screens 1h before bed', cat: 'sleep' },
            { desc: 'Gratitude Journal', cat: 'mindfulness' }
        ],
        'fitness': [
            { desc: 'Warm-up / Mobility', cat: 'warmup' },
            { desc: 'Main Workout', cat: 'workout' },
            { desc: 'Protein intake met', cat: 'nutrition' },
            { desc: 'Stretching / Cool down', cat: 'recovery' }
        ],
        'study': [
            { desc: 'Review previous notes', cat: 'review' },
            { desc: 'Active Recall Session', cat: 'learning' },
            { desc: 'Practice Problems', cat: 'practice' },
            { desc: 'Summarize key concepts', cat: 'synthesis' }
        ]
    };

    document.getElementById('category-select').addEventListener('change', function (e) {
        const category = e.target.value;
        const preview = document.getElementById('preview-content');

        if (!category || !templates[category]) {
            preview.innerHTML = '<p class="text-secondary" style="text-align: center; padding: 2rem;">No activities (you can add them later)</p>';
            return;
        }

        const activities = templates[category];
        let html = '<div style="display: flex; flex-direction: column; gap: 0.75rem;">';

        activities.forEach((activity, index) => {
            html += `
            <div style="padding: 0.75rem; background: var(--color-surface); border-radius: 8px; border-left: 3px solid var(--color-primary);">
                <div style="font-weight: 500;">${activity.desc}</div>
                <span class="badge badge-primary" style="margin-top: 0.25rem;">${activity.cat}</span>
            </div>
        `;
        });

        html += '</div>';
        preview.innerHTML = html;
    });
</script>
{% endblock %}