{% extends 'base.html' %}


{% block content %}
<div class="panel fade-in">
    <header class="panel-header mb-8 flex justify-between items-center">
        <div>
            <h1 class="text-3xl font-bold">Goals</h1>
            <p class="text-secondary">Set bigger targets and track milestones</p>
        </div>
        <button class="btn btn-primary" onclick="window.openModal('add-goal')">
            Add Goal
        </button>
    </header>

    <!-- Goal Stats -->
    <div class="grid-responsive mb-8">
        <div class="card stat-card">
            <div class="stat-value">{{ goal_stats.total_active }}</div>
            <div class="stat-label">Active Goals</div>
        </div>
        <div class="card stat-card">
            <div class="stat-value">{{ goal_stats.on_track }}</div>
            <div class="stat-label">On Track</div>
        </div>
        <div class="card stat-card">
            <div class="stat-value">{{ goal_stats.avg_progress }}%</div>
            <div class="stat-label">Avg Progress</div>
        </div>
    </div>

    <!-- Goals List -->
    {% if active_goals %}
    <div class="space-y-4">
        {% for goal in active_goals %}
        <div class="card p-6 flex flex-col md:flex-row md:items-center justify-between gap-4 group hover:border-primary transition-colors cursor-pointer"
            onclick="window.openModal('edit-goal', {goal_id: '{{ goal.goal_id }}'})">
            <div class="flex items-start gap-4">
                <div class="text-3xl">{{ goal.icon|default:"üéØ" }}</div>
                <div>
                    <h3 class="font-bold text-lg mb-1">{{ goal.title }}</h3>
                    <p class="text-sm text-secondary">{{ goal.description }}</p>
                    <div class="text-xs text-secondary mt-2">
                        Deadline: {{ goal.deadline|default:"No deadline" }}
                    </div>
                </div>
            </div>

            <div class="flex-1 w-full md:max-w-xs">
                <div class="flex justify-between text-sm mb-2">
                    <span class="font-bold">{{ goal.current_value }} / {{ goal.target_value }}</span>
                    <span class="text-secondary">{{ goal.progress }}%</span>
                </div>
                <div class="h-2 bg-bg rounded overflow-hidden">
                    <div class="h-full bg-primary transition-all duration-500" style="width: {{ goal.progress }}%">
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state card p-12 text-center">
        <div class="empty-icon text-5xl mb-4">üèÜ</div>
        <h3 class="text-xl font-bold mb-2">No active goals</h3>
        <p class="text-secondary mb-6">Goals help you track long-term achievements.</p>
        <button class="btn btn-primary" onclick="window.openModal('add-goal')">Create a Goal</button>
    </div>
    {% endif %}

    <!-- Completed Goals -->
    {% if completed_goals %}
    <div class="mt-12 pt-8 border-t border-border">
        <h3 class="text-lg font-bold mb-4 opacity-80">Completed Goals</h3>
        <div class="space-y-3 opacity-60 hover:opacity-100 transition-opacity">
            {% for goal in completed_goals %}
            <div class="card p-4 flex justify-between items-center bg-surface-alt">
                <div class="flex items-center gap-3">
                    <span>‚úÖ</span>
                    <span class="font-medium line-through">{{ goal.title }}</span>
                </div>
                <span class="text-sm text-success font-bold">Done!</span>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}