{% load static %}
<div class="panel" data-panel="goals">
    <div class="breadcrumb">
        <a href="/">Home</a>
        <span class="breadcrumb-separator">‚Ä∫</span>
        <span>Goals</span>
    </div>

    <div class="panel-header">
        <h1 class="panel-title">üéØ Your Goals</h1>
        <div class="panel-actions">
            <button class="btn btn-primary" data-action="add-goal">
                <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                        d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                        clip-rule="evenodd" />
                </svg>
                New Goal
            </button>
        </div>
    </div>

    <!-- Goal Stats -->
    <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
        <div class="stat-card">
            <div class="stat-value">{{ goal_stats.total_active }}</div>
            <div class="stat-label">Active Goals</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ goal_stats.avg_progress }}%</div>
            <div class="stat-label">Average Progress</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ goal_stats.on_track }}</div>
            <div class="stat-label">On Track</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ goal_stats.at_risk }}</div>
            <div class="stat-label">At Risk</div>
        </div>
    </div>

    <!-- Active Goals -->
    {% if active_goals %}
    <section style="margin-bottom: 3rem;">
        <h2 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem;">Active Goals</h2>
        <div style="display: grid; gap: 1rem;">
            {% for goal in active_goals %}
            <div class="goal-card"
                style="background: var(--color-surface); border: 1px solid var(--color-border); border-radius: 16px; padding: 1.5rem; transition: all 0.2s;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                    <div style="flex: 1;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                            <div style="font-size: 2rem;">{{ goal.icon|default:"üéØ" }}</div>
                            <h3 style="font-size: 1.125rem; font-weight: 600; margin: 0;">{{ goal.title }}</h3>
                        </div>
                        {% if goal.description %}
                        <p style="color: var(--color-text-secondary); margin: 0 0 0 3.5rem; font-size: 0.875rem;">
                            {{ goal.description }}
                        </p>
                        {% endif %}
                    </div>

                    <div class="dropdown">
                        <button class="btn-icon dropdown-toggle" aria-label="More options">
                            <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z" />
                            </svg>
                        </button>
                        <div class="dropdown-menu">
                            <button class="dropdown-item" data-action="edit-goal"
                                data-goal-id="{{ goal.goal_id }}">Edit</button>
                            <button class="dropdown-item" data-action="complete-goal"
                                data-goal-id="{{ goal.goal_id }}">Mark Complete</button>
                            <div class="dropdown-divider"></div>
                            <button class="dropdown-item dropdown-item-danger" data-action="delete-goal"
                                data-goal-id="{{ goal.goal_id }}">Delete</button>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 1rem;">
                    <div
                        style="display: flex; justify-content: space-between; font-size: 0.875rem; margin-bottom: 0.5rem;">
                        <span style="color: var(--color-text-secondary);">Progress</span>
                        <span style="font-weight: 600; color: var(--color-primary);">
                            {{ goal.current_value }}/{{ goal.target_value }} ({{ goal.progress }}%)
                        </span>
                    </div>
                    <div class="progress-bar" style="height: 12px;">
                        <div
                            style="width: {{ goal.progress }}%; background: {% if goal.progress >= 80 %}var(--color-success){% elif goal.progress >= 50 %}var(--color-primary){% else %}var(--color-warning){% endif %}; transition: width 0.3s;">
                        </div>
                    </div>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.875rem;">
                    <div style="color: var(--color-text-secondary);">
                        {% if goal.deadline %}
                        üìÖ Due: {{ goal.deadline|date:"M d, Y" }}
                        {% else %}
                        No deadline set
                        {% endif %}
                    </div>
                    <div>
                        {% if goal.progress >= 80 %}
                        <span style="color: var(--color-success); font-weight: 600;">‚úì On Track</span>
                        {% elif goal.progress >= 50 %}
                        <span style="color: var(--color-primary); font-weight: 600;">‚Üí In Progress</span>
                        {% else %}
                        <span style="color: var(--color-warning); font-weight: 600;">‚ö† Needs Attention</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% else %}
    <div class="empty-state">
        <svg class="empty-state-icon" width="80" height="80" viewBox="0 0 20 20" fill="currentColor">
            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
            <path fill-rule="evenodd"
                d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd" />
        </svg>
        <h3 class="empty-state-title">No active goals</h3>
        <p class="empty-state-description">Set a goal to track your long-term progress</p>
        <button class="btn btn-primary" data-action="add-goal">Create Your First Goal</button>
    </div>
    {% endif %}

    <!-- Completed Goals -->
    {% if completed_goals %}
    <section>
        <h2 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem; color: var(--color-text-secondary);">
            ‚úÖ Completed Goals
        </h2>
        <div style="display: grid; gap: 0.75rem;">
            {% for goal in completed_goals %}
            <div
                style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--color-success-bg); border-radius: 8px;">
                <div style="display: flex; align-items: center; gap: 0.75rem;">
                    <div style="font-size: 1.5rem;">{{ goal.icon|default:"üèÜ" }}</div>
                    <div>
                        <div style="font-weight: 600;">{{ goal.title }}</div>
                        <div style="font-size: 0.75rem; color: var(--color-text-secondary);">
                            Completed {{ goal.updated_at|date:"M d, Y" }}
                        </div>
                    </div>
                </div>
                <div style="color: var(--color-success); font-weight: 600;">100%</div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</div>

<style>
    .goal-card:hover {
        border-color: var(--color-primary);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }
</style>