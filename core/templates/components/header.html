{% load static %}
<!-- Horizontal Header -->
<header class="app-header">
    <div class="header-left">
        <!-- Mobile Sidebar Toggle -->
        <button class="sidebar-toggle header-btn" id="sidebar-toggle" aria-label="Toggle sidebar">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path d="M2 4h16M2 10h16M2 16h16" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
        </button>

        <!-- Logo & Brand -->
        <a href="/" class="header-brand">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z" />
            </svg>
            <span class="brand-text">Tracker Pro</span>
        </a>
    </div>

    <!-- Center Search (Desktop) -->
    <div class="header-center">
        <div class="search-box">
            <svg class="search-icon" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                <path
                    d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" />
            </svg>
            <input type="text" class="search-input" placeholder="Search tasks, trackers..." id="global-search"
                aria-label="Global search">
            <kbd class="search-kbd">âŒ˜K</kbd>
        </div>
    </div>

    <!-- Right Actions -->
    <div class="header-right">
        <!-- Notifications -->
        <div class="dropdown" id="notifications-dropdown">
            <button class="header-btn dropdown-toggle" id="notifications-btn" aria-label="Notifications"
                aria-haspopup="true" aria-expanded="false">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path
                        d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" />
                </svg>
                {% if unread_notifications_count > 0 %}
                <span class="notification-badge">{{ unread_notifications_count }}</span>
                {% endif %}
            </button>

            <div class="dropdown-menu">
                <div class="dropdown-header">Notifications</div>
                <div id="notifications-list">
                    <div class="empty-state" style="padding: 2rem 1rem;">
                        <p class="empty-state-description" style="margin: 0;">No new notifications</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Theme Switcher -->
        <button class="header-btn" id="theme-btn" aria-label="Toggle theme" title="Toggle theme">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
            </svg>
        </button>

        <!-- Profile Menu -->
        <div class="dropdown" id="profile-dropdown">
            <button class="header-btn dropdown-toggle user-avatar" id="profile-btn" aria-label="Profile menu"
                aria-haspopup="true" aria-expanded="false">
                {% if user.profile_image %}
                <img src="{{ user.profile_image }}" alt="{{ user.username }}"
                    style="width: 36px; height: 36px; border-radius: 50%;">
                {% else %}
                <div class="avatar-initials">
                    {{ user.username|slice:":2"|upper|default:"U" }}
                </div>
                {% endif %}
            </button>

            <div class="dropdown-menu">
                <div class="dropdown-header">
                    {{ user.email|default:"User" }}
                </div>
                <a href="/settings/" class="dropdown-item" data-panel="settings">
                    <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                        <path
                            d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z" />
                    </svg>
                    Settings
                </a>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item dropdown-item-danger" data-action="logout">
                    <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                        <path
                            d="M3 3a1 1 0 011-1h8a1 1 0 011 1v14a1 1 0 01-1 1H4a1 1 0 01-1-1V3zM13 5l5 5-5 5v-3H9V8h4V5z" />
                    </svg>
                    Logout
                </button>
            </div>
        </div>
    </div>
</header>

<style>
    .header-btn {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        padding: 0.5rem;
        background: transparent;
        border: none;
        border-radius: 8px;
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all 0.2s;
    }

    .header-btn:hover {
        background: var(--color-bg);
        color: var(--color-text-primary);
    }

    .header-btn:focus {
        outline: none;
        box-shadow: 0 0 0 3px var(--color-focus-ring);
    }
</style>