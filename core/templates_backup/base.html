{% load static %}
<!DOCTYPE html>
<html lang="en" data-theme="working-hard">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracker Pro</title>
    <link rel="stylesheet" href="{% static 'core/css/themes.css' %}">
    <link rel="stylesheet" href="{% static 'core/css/components.css' %}">
    <link rel="stylesheet" href="{% static 'core/css/auth.css' %}">

    <link rel="stylesheet" href="{% static 'core/css/enhancements.css' %}">
    <link rel="icon" type="image/x-icon" href="{% static 'icons/fav.ico' %}">
</head>

<body>
    {% csrf_token %}
    <!-- SVG Sprite -->
    <div style="display:none;">
        <!-- Fallback if include fails or static file serving issues -->
        <svg xmlns="http://www.w3.org/2000/svg">
            <symbol id="home" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            </symbol>
            <symbol id="list" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="8" y1="6" x2="21" y2="6"></line>
                <line x1="8" y1="12" x2="21" y2="12"></line>
                <line x1="8" y1="18" x2="21" y2="18"></line>
                <line x1="3" y1="6" x2="3" y2="6"></line>
                <line x1="3" y1="12" x2="3" y2="12"></line>
                <line x1="3" y1="18" x2="3" y2="18"></line>
            </symbol>
            <symbol id="chart" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="20" x2="18" y2="10"></line>
                <line x1="12" y1="20" x2="12" y2="4"></line>
                <line x1="6" y1="20" x2="6" y2="14"></line>
            </symbol>
        </svg>
    </div>

    <div class="sidebar-layout {% if not user.is_authenticated %}auth-layout{% endif %}">
        {% if user.is_authenticated %}
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand"
                style="margin-bottom: 2rem; font-size: 1.5rem; font-weight: bold; color: var(--color-primary);">
                <svg class="icon" width="24" height="24" style="vertical-align: middle;">
                    <use href="/static/icons/sprite.svg#chart"></use>
                </svg>
                Tracker Pro
            </div>

            <div
                style="background: rgba(var(--color-primary-rgb, 2, 119, 189), 0.1); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                <div style="font-size: 0.75rem; color: var(--color-text-secondary); margin-bottom: 0.25rem;">Logged in
                    as</div>
                <div style="font-weight: 600; margin-bottom: 0.75rem; color: var(--color-text-secondary); word-break: break-word;">{{ user.email }}</div>
                <a href="{% url 'logout' %}" class="btn btn-ghost logout-btn" data-logout
                    style="width: 100%; justify-content: center; font-size: 0.875rem; text-decoration: none; color: var(--color-text-secondary); border: 1px solid var(--color-border);">
                    Logout
                </a>
            </div>

            <!-- Main Navigation -->
            <nav class="nav-main" style="display: flex; flex-direction: column; gap: 0.5rem;">
                <div
                    style="font-size: 0.75rem; font-weight: 600; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 0.5rem; margin-bottom: 0.5rem;">
                    Main
                </div>

                <a href="{% url 'dashboard' %}" class="btn btn-ghost" style="justify-content: flex-start;">
                    <svg class="icon" width="20" height="20">
                        <use href="/static/icons/sprite.svg#home"></use>
                    </svg>
                    Dashboard
                </a>

                <a href="{% url 'tracker_list' %}" class="btn btn-ghost" style="justify-content: flex-start;">
                    <svg class="icon" width="20" height="20">
                        <use href="/static/icons/sprite.svg#list"></use>
                    </svg>
                    My Trackers
                </a>

                <a href="{% url 'create_tracker' %}" class="btn btn-primary" style="justify-content: flex-start;">
                    <svg class="icon" width="20" height="20">
                        <use href="/static/icons/sprite.svg#plus"></use>
                    </svg>
                    New Tracker
                </a>

                <div style="height: 1px; background: var(--color-border); margin: 1rem 0;"></div>

                <div
                    style="font-size: 0.75rem; font-weight: 600; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem;">
                    Resources
                </div>

                <a href="{% url 'templates_library' %}" class="btn btn-ghost" style="justify-content: flex-start;">
                    <svg class="icon" width="20" height="20">
                        <use href="/static/icons/sprite.svg#list"></use>
                    </svg>
                    Templates
                </a>

                <a href="{% url 'history' %}" class="btn btn-ghost" style="justify-content: flex-start;">
                    <svg class="icon" width="20" height="20">
                        <use href="/static/icons/sprite.svg#chart"></use>
                    </svg>
                    History
                </a>

                <a href="{% url 'help_center' %}" class="btn btn-ghost" style="justify-content: flex-start;">
                    <svg class="icon" width="20" height="20">
                        <use href="/static/icons/sprite.svg#settings"></use>
                    </svg>
                    Help & Guide
                </a>

                <!-- Quick Info -->
                <div
                    style="margin-top: auto; padding: 1rem; background: rgba(var(--color-primary-rgb, 2, 119, 189), 0.1); border-radius: 8px; margin-bottom: 1rem;">
                    <div style="font-size: 0.75rem; color: var(--color-text-secondary); margin-bottom: 0.5rem;">Quick
                        Tip</div>
                    <div style="font-size: 0.875rem;">Use Today view for quick daily tracking!</div>
                </div>
            </nav>

            <div style="margin-top: auto;">
                <label class="form-label">Theme</label>
                <select id="theme-switcher" class="form-select">
                    <option value="working-hard">Working Hard</option>
                    <option value="rage">Rage</option>
                    <option value="bloom">Bloom</option>
                    <option value="blossom">Blossom</option>
                    <option value="cherry">Cherry</option>
                    <option value="horny">Horny</option>
                    <option value="total-dark">Total Dark</option>
                    <option value="rising-up">Rising Up</option>
                    <option value="dig-deep">Dig Deep</option>
                    <option value="sprinter">Sprinter</option>
                    <option value="rider">Rider</option>
                    <option value="beast-mode">Beast Mode</option>
                    <option value="ocean-wave">Ocean Wave</option>
                    <option value="sunset-grind">Sunset Grind</option>
                    <option value="ice-cold">Ice Cold</option>
                    <option value="warrior-spirit">Warrior Spirit</option>
                    <option value="neon-pulse">Neon Pulse</option>
                    <option value="forest-trail">Forest Trail</option>
                    <option value="midnight-oil">Midnight Oil</option>
                    <option value="gold-rush">Gold Rush</option>
                    <option value="arctic-blast">Arctic Blast</option>
                    <option value="volcano">Volcano</option>
                    <option value="zen-master">Zen Master</option>
                    <option value="cyberpunk">Cyberpunk</option>
                    <option value="desert-storm">Desert Storm</option>
                    <option value="northern-lights">Northern Lights</option>
                </select>
            </div>
        </aside>
        {% endif %}

        <!-- Main Content -->
        <main class="main-content">
            {% block content %}
            {% endblock %}
        </main>
    </div>

    <style>
        /* Auth Layout Overrides */
        .auth-layout {
            display: block !important;
            height: 100vh;
            width: 100vw;
            overflow-x: hidden;
        }

        .auth-layout .main-content {
            padding: 0 !important;
            width: 100%;
            height: 100%;
            max-width: none !important;
        }
    </style>

    <script>
        // Theme Switcher Logic
        const themeSelect = document.getElementById('theme-switcher');
        const html = document.documentElement;

        const savedTheme = localStorage.getItem('tracker-theme') || 'working-hard';
        html.setAttribute('data-theme', savedTheme);
        themeSelect.value = savedTheme;

        themeSelect.addEventListener('change', (e) => {
            const theme = e.target.value;
            html.setAttribute('data-theme', theme);
            localStorage.setItem('tracker-theme', theme);
        });
    </script>

    <!-- Enhancements Script -->
    <script src="{% static 'core/js/enhancements.js' %}"></script>

    {% if user.is_authenticated %}
    <!-- Authentication Script (for logout functionality) -->
    <script type="module" src="{% static 'core/js/auth.js' %}"></script>
    {% endif %}
</body>

</html>